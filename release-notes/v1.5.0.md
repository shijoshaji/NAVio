# Release Notes - v1.5.0 ğŸ¯
**"The Sold Tab & Tracker Cleanup Update"**

**Release Date**: December 23, 2025
**Focus**: Enhanced Sold Holdings View, Tracker Filtering, and Layout Optimization.

---

## âœ¨ New Features

### ğŸ“Š Exited/Sold Tab Enhancements
A complete overhaul of how you view and analyze your sold investments.

-   **Active/Sold Tabs**: Holdings page now features dedicated tabs to separate current investments from fully redeemed ones.
-   **Exit Summary Column**: Consolidated view showing Units Sold, Sold NAV, and Current NAV in one place.
-   **Amount Column**: New column displaying both "Invested" (total amount put in) and "Exited" (total realized value) for complete transparency.
-   **Original Buy Details**: Sub-header displays original bought units and weighted average buy NAV, not just zeros.
-   **Term Classification**: Visual indicators showing "Short Term" vs "Long Term" holdings with color-coded badges (Amber/Emerald).
-   **Duration Tracking**: See the complete investment lifecycle with "Idle" time calculation (e.g., "Idle: 1Y.2M.15D").
-   **Realized P&L**: Clear profit/loss display with percentage returns for each sold investment.
-   **Tax Status Calculation**: Automatic classification based on holding period (Equity > 1 year, Others > 3 years).

### ğŸ§¹ Tracker Filtering
Keep your SIP and Lumpsum trackers clean and focused.

-   **Active-Only Mode**: Sold schemes are now automatically filtered out from SIP and Lumpsum history views.
-   **Backend Filtering**: Efficient database-level filtering using Portfolio table to check active status.
-   **Cleaner UI**: No more clutter from fully redeemed investments in your tracker lists.

### ğŸ—‘ï¸ Scheme History Management
-   **Delete History**: New delete functionality for sold schemes with confirmation modal.
-   **Permanent Removal**: Clean up your database by removing transaction history for schemes you no longer track.
-   **Safety Warning**: Clear confirmation dialog warns about permanent deletion and P&L impact.

## ğŸ› ï¸ UI & UX Enhancements

### ğŸ“ Layout Optimization
-   **Full-Width Layout**: Removed restrictive `max-w-7xl` constraint, allowing tables to utilize full screen width.
-   **Optimized Column Spacing**: Improved column width distribution in Sold tab for better readability:
    -   Exit Summary: 20% (min 200px)
    -   Amount: 18% (min 140px)
    -   Duration: 15% (min 120px)
    -   Term: 10% (min 100px)
    -   Realized P&L: 12% (min 100px)
-   **Responsive Design**: Minimum width constraints prevent column shrinking on smaller screens.

### ğŸ¨ Visual Improvements
-   **Color-Coded Terms**: Long-term holdings in emerald, short-term in amber for instant recognition.
-   **Improved Text Contrast**: Enhanced readability with better color choices (e.g., `text-slate-200` for idle time).
-   **Grouped View Enhancements**: Accurate aggregation of Invested/Exited amounts in group headers.

### ğŸ“„ Pagination
-   **Client-Side Pagination**: Smooth navigation through large holdings lists.
-   **Customizable Rows**: Choose between 5, 10, 20, 30, or 40 records per page.
-   **Page Navigation**: Clear page indicators and previous/next controls.

---

## ğŸ› Bug Fixes & Improvements

-   **Fixed**: Group header totals now correctly accumulate `totalInvested`, `totalRealizedPnl`, and `totalGrossInvested`.
-   **Fixed**: Sold tab filtering now respects `activeTab` state changes.
-   **Fixed**: Column alignment issues in Sold tab resolved with proper width distribution.
-   **Improved**: Backend `get_portfolio_summary` now calculates comprehensive sold metrics including `total_units_bought`, `gross_invested_amount`, and `avg_buy_nav`.
-   **Improved**: API endpoint `get_investments` now supports `active_only` parameter for efficient filtering.

---

## ğŸ”§ Technical Changes

### Backend
-   **portfolio.py**: Enhanced `get_portfolio_summary` with sold scheme metrics calculation.
-   **main.py**: Added `active_only` parameter to `/api/investments` endpoint.
-   **main.py**: New DELETE endpoint `/api/portfolio/scheme/{scheme_code}` for history cleanup.

### Frontend
-   **Holdings.jsx**: Complete refactor of Sold tab with new columns and enhanced grouping logic.
-   **Layout.jsx**: Removed `max-w-7xl` constraint for full-width content area.
-   **api.js**: Updated `getInvestments` to support `activeOnly` parameter.
-   **SipTracker.jsx**: Now fetches only active schemes by default.
-   **LumpsumTracker.jsx**: Now fetches only active schemes by default.

---

> **Upgrade Instruction**: No database migration required. Simply pull the latest code and refresh your browser!

## ğŸ“Š Summary
v1.5.0 brings clarity to your investment history. The new **Exited/Sold tab** provides comprehensive insights into your realized investments with detailed metrics, while **tracker filtering** keeps your active views clean and focused. Combined with **layout optimizations**, NAViÅ now offers a more spacious and organized portfolio management experience.

---
